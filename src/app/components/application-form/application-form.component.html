<section class="application-form section" id="aplica">
    <div class="application-form__container">
        <!-- Section Header -->
        <div class="application-form__header">
            <h2 class="application-form__title">{{ t('form.title') }}</h2>
            <p class="application-form__subtitle">{{ t('form.subtitle') }}</p>
        </div>

        @if (isSubmitted()) {
        <!-- Success State -->
        <div class="application-form__success">
            <div class="application-form__success-icon">âœ…</div>
            <h3 class="application-form__success-title">{{ t('form.success.title') }}</h3>
            <p class="application-form__success-text">{{ t('form.success.message') }}</p>
            <button type="button" class="application-form__reset-btn" (click)="resetForm()">
                {{ t('common.resetForm') }}
            </button>
        </div>
        } @else {
        <!-- Form -->
        <form class="form" [formGroup]="form" (ngSubmit)="onSubmit()">
            <div class="form__grid">
                <!-- Full Name -->
                <div class="form__field form__field--full">
                    <label class="form__label" for="fullName">{{ t('form.fields.fullName') }} *</label>
                    <input type="text" id="fullName" class="form__input"
                        [class.error]="form.get('fullName')?.invalid && form.get('fullName')?.touched"
                        formControlName="fullName" [placeholder]="t('form.fields.fullNamePlaceholder')">
                    @if (form.get('fullName')?.invalid && form.get('fullName')?.touched) {
                    <span class="form__error">{{ t('form.errors.fullNameRequired') }}</span>
                    }
                </div>

                <!-- Email -->
                <div class="form__field">
                    <label class="form__label" for="email">{{ t('form.fields.email') }} *</label>
                    <input type="email" id="email" class="form__input"
                        [class.error]="form.get('email')?.invalid && form.get('email')?.touched" formControlName="email"
                        [placeholder]="t('form.fields.emailPlaceholder')">
                    @if (form.get('email')?.invalid && form.get('email')?.touched) {
                    <span class="form__error">{{ t('form.errors.emailRequired') }}</span>
                    }
                </div>

                <!-- Phone -->
                <div class="form__field">
                    <label class="form__label" for="phone">{{ t('form.fields.phone') }} *</label>
                    <input type="tel" id="phone" class="form__input"
                        [class.error]="form.get('phone')?.invalid && form.get('phone')?.touched" formControlName="phone"
                        [placeholder]="t('form.fields.phonePlaceholder')">
                    @if (form.get('phone')?.invalid && form.get('phone')?.touched) {
                    <span class="form__error">{{ t('form.errors.phoneRequired') }}</span>
                    }
                </div>

                <!-- Profession -->
                <div class="form__field">
                    <label class="form__label" for="profession">{{ t('form.fields.profession') }} *</label>
                    <select id="profession" class="form__select"
                        [class.error]="form.get('profession')?.invalid && form.get('profession')?.touched"
                        formControlName="profession">
                        <option value="" disabled>{{ t('form.fields.professionPlaceholder') }}</option>
                        @for (profession of professions; track profession) {
                        <option [value]="profession">{{ profession }}</option>
                        }
                    </select>
                    @if (form.get('profession')?.invalid && form.get('profession')?.touched) {
                    <span class="form__error">{{ t('form.errors.professionRequired') }}</span>
                    }
                </div>

                <!-- Experience -->
                <div class="form__field">
                    <label class="form__label" for="experience">{{ t('form.fields.experience') }} *</label>
                    <select id="experience" class="form__select"
                        [class.error]="form.get('experience')?.invalid && form.get('experience')?.touched"
                        formControlName="experience">
                        <option value="" disabled>{{ t('form.fields.experiencePlaceholder') }}</option>
                        @for (exp of experienceOptions; track exp) {
                        <option [value]="exp">{{ exp }}</option>
                        }
                    </select>
                    @if (form.get('experience')?.invalid && form.get('experience')?.touched) {
                    <span class="form__error">{{ t('form.errors.experienceRequired') }}</span>
                    }
                </div>

                <!-- Languages -->
                <div class="form__field form__field--full">
                    <label class="form__label">{{ t('form.fields.languages') }} *</label>
                    <div class="form__checkboxes">
                        @for (lang of languages; track lang.id) {
                        <label class="form__checkbox">
                            <input type="checkbox" [formControlName]="lang.id" class="form__checkbox-input">
                            <span class="form__checkbox-custom"></span>
                            <span class="form__checkbox-label">{{ lang.label }}</span>
                        </label>
                        }
                    </div>
                    @if (!hasLanguageSelected && form.touched) {
                    <span class="form__error">{{ t('form.errors.languageRequired') }}</span>
                    }
                </div>

                <!-- CV Upload -->
                <div class="form__field form__field--full">
                    <label class="form__label">{{ t('form.fields.cv') }}</label>
                    <div class="form__upload" [class.has-file]="fileName()">
                        @if (fileName()) {
                        <div class="form__upload-file">
                            <span class="form__upload-filename">ðŸ“„ {{ fileName() }}</span>
                            <button type="button" class="form__upload-remove" (click)="removeFile()">âœ•</button>
                        </div>
                        } @else {
                        <label class="form__upload-label" for="cv">
                            <span class="form__upload-icon">ðŸ“„</span>
                            <span class="form__upload-text">{{ t('form.fields.cvUpload') }}</span>
                        </label>
                        <input type="file" id="cv" class="form__upload-input" accept=".pdf,.doc,.docx"
                            (change)="onFileSelected($event)">
                        }
                    </div>
                </div>
            </div>

            <!-- Submit Button -->
            <button type="submit" class="form__submit" [disabled]="isSubmitting()">
                @if (isSubmitting()) {
                <span class="form__submit-spinner"></span>
                {{ t('common.sending') }}
                } @else {
                {{ t('common.submit') }}
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M5 12h14M12 5l7 7-7 7" />
                </svg>
                }
            </button>
        </form>
        }
    </div>
</section>
