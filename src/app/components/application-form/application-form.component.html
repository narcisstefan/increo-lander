<section class="application-form section" id="aplica">
    <div class="application-form__container">
        <!-- Section Header -->
        <div class="application-form__header">
            <h2 class="application-form__title">AplicÄƒ Acum</h2>
            <p class="application-form__subtitle">CompleteazÄƒ formularul È™i te vom contacta Ã®n 24 de ore</p>
        </div>

        @if (isSubmitted()) {
        <!-- Success State -->
        <div class="application-form__success">
            <div class="application-form__success-icon">âœ…</div>
            <h3 class="application-form__success-title">AplicaÈ›ie TrimisÄƒ cu Succes!</h3>
            <p class="application-form__success-text">
                MulÈ›umim pentru interes! Te vom contacta Ã®n maximum 24 de ore pentru a discuta despre oportunitÄƒÈ›ile
                disponibile.
            </p>
            <button type="button" class="application-form__reset-btn" (click)="resetForm()">
                Trimite o NouÄƒ AplicaÈ›ie
            </button>
        </div>
        } @else {
        <!-- Form -->
        <form class="form" [formGroup]="form" (ngSubmit)="onSubmit()">
            <div class="form__grid">
                <!-- Full Name -->
                <div class="form__field form__field--full">
                    <label class="form__label" for="fullName">Nume Complet *</label>
                    <input type="text" id="fullName" class="form__input"
                        [class.error]="form.get('fullName')?.invalid && form.get('fullName')?.touched"
                        formControlName="fullName" placeholder="Ex: Ion Popescu">
                    @if (form.get('fullName')?.invalid && form.get('fullName')?.touched) {
                    <span class="form__error">Numele este obligatoriu (min. 3 caractere)</span>
                    }
                </div>

                <!-- Email -->
                <div class="form__field">
                    <label class="form__label" for="email">Email *</label>
                    <input type="email" id="email" class="form__input"
                        [class.error]="form.get('email')?.invalid && form.get('email')?.touched" formControlName="email"
                        placeholder="email@exemplu.com">
                    @if (form.get('email')?.invalid && form.get('email')?.touched) {
                    <span class="form__error">AdresÄƒ de email validÄƒ este obligatorie</span>
                    }
                </div>

                <!-- Phone -->
                <div class="form__field">
                    <label class="form__label" for="phone">Telefon (WhatsApp) *</label>
                    <input type="tel" id="phone" class="form__input"
                        [class.error]="form.get('phone')?.invalid && form.get('phone')?.touched" formControlName="phone"
                        placeholder="+40 7XX XXX XXX">
                    @if (form.get('phone')?.invalid && form.get('phone')?.touched) {
                    <span class="form__error">NumÄƒr de telefon valid este obligatoriu</span>
                    }
                </div>

                <!-- Profession -->
                <div class="form__field">
                    <label class="form__label" for="profession">Meseria PrincipalÄƒ *</label>
                    <select id="profession" class="form__select"
                        [class.error]="form.get('profession')?.invalid && form.get('profession')?.touched"
                        formControlName="profession">
                        <option value="" disabled>SelecteazÄƒ meseria</option>
                        @for (profession of professions; track profession) {
                        <option [value]="profession">{{ profession }}</option>
                        }
                    </select>
                    @if (form.get('profession')?.invalid && form.get('profession')?.touched) {
                    <span class="form__error">SelecteazÄƒ meseria ta</span>
                    }
                </div>

                <!-- Experience -->
                <div class="form__field">
                    <label class="form__label" for="experience">Ani de ExperienÈ›Äƒ *</label>
                    <select id="experience" class="form__select"
                        [class.error]="form.get('experience')?.invalid && form.get('experience')?.touched"
                        formControlName="experience">
                        <option value="" disabled>SelecteazÄƒ experienÈ›a</option>
                        @for (exp of experienceOptions; track exp) {
                        <option [value]="exp">{{ exp }}</option>
                        }
                    </select>
                    @if (form.get('experience')?.invalid && form.get('experience')?.touched) {
                    <span class="form__error">SelecteazÄƒ experienÈ›a ta</span>
                    }
                </div>

                <!-- Languages -->
                <div class="form__field form__field--full">
                    <label class="form__label">Limbi StrÄƒine Cunoscute *</label>
                    <div class="form__checkboxes">
                        @for (lang of languages; track lang.id) {
                        <label class="form__checkbox">
                            <input type="checkbox" [formControlName]="lang.id" class="form__checkbox-input">
                            <span class="form__checkbox-custom"></span>
                            <span class="form__checkbox-label">{{ lang.label }}</span>
                        </label>
                        }
                    </div>
                    @if (!hasLanguageSelected && form.touched) {
                    <span class="form__error">SelecteazÄƒ cel puÈ›in o limbÄƒ strÄƒinÄƒ</span>
                    }
                </div>

                <!-- CV Upload -->
                <div class="form__field form__field--full">
                    <label class="form__label">ÃŽncarcÄƒ CV (PDF, DOC) - opÈ›ional</label>
                    <div class="form__upload" [class.has-file]="fileName()">
                        @if (fileName()) {
                        <div class="form__upload-file">
                            <span class="form__upload-filename">ðŸ“„ {{ fileName() }}</span>
                            <button type="button" class="form__upload-remove" (click)="removeFile()">âœ•</button>
                        </div>
                        } @else {
                        <label class="form__upload-label" for="cv">
                            <span class="form__upload-icon">ðŸ“„</span>
                            <span class="form__upload-text">Drag & drop sau click pentru a Ã®ncÄƒrca</span>
                        </label>
                        <input type="file" id="cv" class="form__upload-input" accept=".pdf,.doc,.docx"
                            (change)="onFileSelected($event)">
                        }
                    </div>
                </div>
            </div>

            <!-- Submit Button -->
            <button type="submit" class="form__submit" [disabled]="isSubmitting()">
                @if (isSubmitting()) {
                <span class="form__submit-spinner"></span>
                Se trimite...
                } @else {
                Trimite AplicaÈ›ia
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M5 12h14M12 5l7 7-7 7" />
                </svg>
                }
            </button>
        </form>
        }
    </div>
</section>